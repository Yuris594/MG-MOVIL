(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7284],{42286:function(e,t,a){Promise.resolve().then(a.bind(a,35692))},35692:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return F}});var o=a(57437),l=a(79647),i=a(17156),s=a(76548),n=a(14595),r=a(47703),d=a(85800);a(27824);var c=a(97501),_=a(59846),h=a(2265),u=function(e,t,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},[i]=(0,h.useState)(null),[s,n]=(0,h.useState)(""),[r]=(0,h.useState)((0,_.WU)(new Date,"dd/MM/yyyy HH:mm:ss"));return(0,h.useEffect)(()=>{(null==e?void 0:e.Fecha)&&(()=>{let t=new Date(e.Fecha),a=t.getDate(),o=t.toLocaleString("es-CO",{month:"short"}),l=o.charAt(0).toUpperCase()+o.slice(1),i=t.getFullYear();n("".concat(l," ").concat(a,", ").concat(i))})()},[e]),{generarPDF:()=>{let i=new c.default("portrait","pt","letter"),n=[{field:"FKcodigo_articles",headerName:"CODIGO",width:150},{field:"Nombre",headerName:"REFERENCIA",width:350},{field:"Cantidad",headerName:"CANTIDAD",width:100},{field:"Precio",headerName:"PRECIO",width:100},{field:"Descuento",headerName:"DESC",width:90},{field:"Iva",headerName:"IVA",width:90},{field:"Total",headerName:"TOTAL",width:100,cellClassName:"total-cell"}],d=a.map(e=>{let t=[];return n.forEach(a=>{let o=e[a.field];("Precio"===a.field||"Total"===a.field)&&(o="$"+parseFloat(Number(o).toFixed(0)).toLocaleString()),t.push(o)}),t});i.setFontSize(13),i.addImage("/logo_factura.png","PNG",16,20,200,25),i.setFontSize(8),i.setFont("courier","italic"),i.text("NOMBRE VENDEDOR: ".concat(t.UserFullName),450,25),i.text("".concat(r),450,35),i.setFontSize(10),i.text("___________________________________________________________________________________________________________",0,60),i.setFont("times","normal"),i.setFontSize(10),i.text("R. SOCIAL: ".concat(null==e?void 0:e.RazonSocial),16,85),i.text("No. PEDIDO: ".concat(null==e?void 0:e.NUMPED),16,105),i.text("FECHA PEDIDO: ".concat(s),200,105),i.text("NIT: ".concat(null==e?void 0:e.FKId_clientes),400,105),i.text("No. FACTURA: ",16,125),i.text("FECHA FACTURA: ",200,125),i.text("DOCUMENTO1: ".concat(null==e?void 0:e.Documento1),400,125),i.setTextColor(255,0,0),i.text("SUBTOTAL: $".concat(l),16,145),i.text("TOTAL: $".concat(o),200,145),i.setTextColor(0,0,0),i.text("NOTAS: ".concat(null==e?void 0:e.Notas),16,165),i.autoTable({head:[n.map(e=>e.headerName)],body:d,startY:180,theme:"plain",tableWidth:i.internal.pageSize.width-28,margin:{left:12,right:16},styles:{theme:"plain",cellWidth:"auto",styles:{cellPadding:5,fontSize:8},lineColor:[200,200,200],lineWidth:.1,font:"times",fontStyle:"normal",textColor:[0,0,0],display:"flex",fontSize:8},headStyles:{font:"courier",fontStyle:"bold"}}),i.output("dataurlnewwindow")},pdfDataUrl:i}},m=a(16463),x=a(86934),g=a(80219),f=a(89967);let N=[{field:"FKcodigo_articles",headerName:"CODIGO",width:150},{field:"Nombre",headerName:"REFERENCIA",width:400},{field:"Cantidad",headerName:"CANTIDAD",width:100},{field:"Precio",headerName:"PRECIO",width:150,valueFormatter:e=>{let t=Number(e).toFixed(0);return"$".concat(parseFloat(t).toLocaleString())}},{field:"Descuento",headerName:"DESCUENTO",width:150},{field:"Iva",headerName:"IVA",width:150},{field:"Total",headerName:"TOTAL",width:150,cellClassName:"total-cell",valueFormatter:e=>{let t=Number(e).toFixed(0);return"$".concat(parseFloat(t).toLocaleString())}}],p=async e=>{let t=await fetch(f.x.url+"/pedidos/Pedidos_Enviados/".concat(e.NUMPED),{method:"GET",headers:{"Content-Type":"application/json"}});return t.ok||400!==t.status?t.json():(console.log("No hay articulos para este cliente"),[])};var F=()=>{let e=(0,m.useRouter)(),{auth:t}=(0,d.a)(),[a,c]=(0,h.useState)(""),[_,f]=(0,h.useState)(""),[F,S]=(0,h.useState)(""),[j,C]=(0,h.useState)([]),[E,w]=(0,h.useState)(null),{generarPDF:D}=u(E,t,j,a,F),v=(0,l.Z)("(max-width: 600px)");(0,h.useEffect)(()=>{E&&T(E.NUMPED)},[E]),(0,h.useEffect)(()=>{let e=localStorage.getItem("detallePedido");e&&w(JSON.parse(e)[0])},[]),(0,h.useEffect)(()=>{(null==E?void 0:E.Fecha)&&(()=>{let e=new Date(E.Fecha),t=e.getDate(),a=e.toLocaleString("es-CO",{month:"short"}),o=a.charAt(0).toUpperCase()+a.slice(1),l=e.getFullYear();f("".concat(o," ").concat(t,", ").concat(l))})()},[E]);let T=async()=>{try{let e=await p(E);e&&C(e)}catch(e){console.log(e)}};return(0,h.useEffect)(()=>{if(j.length>0){let e=j.reduce((e,t)=>{let a=parseFloat(t.Precio);return e+a*parseFloat(t.Cantidad)*(1-parseFloat(t.Descuento)/100)},0),t=j.reduce((e,t)=>e+parseFloat(t.Total),0),a=Number(e.toFixed(0)).toLocaleString(),o=Number(t.toFixed(0)).toLocaleString();S(a),c(o)}},[j]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.Z,{}),(0,o.jsxs)(i.Z,{sx:{display:"flex",flexDirection:v?"column":"row",justifyContent:"space-between",alignItems:"center",width:"auto",margin:2},children:[(0,o.jsxs)(g.Z,{container:!0,rowSpacing:2,columnSpacing:70,children:[(0,o.jsx)(g.Z,{size:{xs:12,sm:8,md:12},children:(0,o.jsx)("strong",{children:"MIGUEL G\xd3MEZ Y COMPA\xd1\xcdA S.A.S"})}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:12},children:[(0,o.jsx)("strong",{children:"Nombre Vendedor: "}),null==t?void 0:t.UserFullName]})]}),(0,o.jsxs)(i.Z,{sx:{margin:2},children:[(0,o.jsx)(s.Z,{onClick:D,color:"success",children:"Generar PDF"}),(0,o.jsx)(s.Z,{onClick:()=>{localStorage.removeItem("detallePedido"),e.push("/pages/pedidoEnviado")},color:"error",children:"Cerrar"})]})]}),(0,o.jsx)(n.Z,{}),(0,o.jsx)(i.Z,{sx:{display:"flex",margin:2},children:(0,o.jsxs)(g.Z,{container:!0,rowSpacing:2,columnSpacing:14,children:[(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,o.jsx)("strong",{children:"No. Pedido: "}),(null==E?void 0:E.NUMPED)||""]}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,o.jsx)("strong",{children:"Fecha Pedido: "}),_||""]}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,o.jsx)("strong",{children:"Nit: "}),(null==E?void 0:E.FKId_clientes)||""]}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:8},children:[(0,o.jsx)("strong",{children:"R. Social: "}),(null==E?void 0:E.RazonSocial)||""]}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,o.jsx)("strong",{children:"Fecha Factura: "}),(null==E?void 0:E.Fecha_Factura)||""]}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,o.jsx)("strong",{children:"SubTotal: "}),(0,o.jsxs)("span",{style:{color:"red"},children:["$",F]})]}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,o.jsx)("strong",{children:"Total: "}),(0,o.jsxs)("span",{style:{color:"red"},children:["$",a]})]}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,o.jsx)("strong",{children:"Documento1: "}),(null==E?void 0:E.Documento1)||""]}),(0,o.jsxs)(g.Z,{size:{xs:12,sm:8,md:6},children:[(0,o.jsx)("strong",{children:"Notas: "}),(null==E?void 0:E.Notas)||""]})]})}),(0,o.jsx)(i.Z,{sx:{height:"auto",width:"auto",margin:2},children:(0,o.jsx)(x._,{rows:j,columns:N,getRowId:e=>e.FKcodigo_articles,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[10],sx:{color:"#000",bgcolor:"#fff"}})})]})}}},function(e){e.O(0,[9461,2505,5148,8965,3083,1092,6934,2398,8242,7703,2971,7023,1744],function(){return e(e.s=42286)}),_N_E=e.O()}]);