"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7703],{59415:function(e,t,i){i.d(t,{zK:function(){return r}});var a=i(68470);let r=async()=>await (0,a.X3)("IDBService",1,{upgrade(e){e.createObjectStore("articles",{keyPath:"PKcodigo"}),e.createObjectStore("cartera",{keyPath:"Documento"}),e.createObjectStore("customers",{keyPath:"NIT"})}})},47703:function(e,t,i){i.d(t,{Z:function(){return U}});var a=i(57437),r=i(20124),n=i(17156),o=i(71733),s=i(79806),l=i(60335),c=i(76548),u=i(83719),d=i(42655),x=i(53006),h=i(34517),g=i(68311),p=i(42188),f=i(51918),j=i(11570),m=i(85983),Z=i(91097),S=i(58188),C=i(44867),y=i(24330),k=i(26032),w=i(59415),b=i(85800),E=i(16463),v=i(2265),N=i(89967),I=i(64379),P=i.n(I),A=i(87138),O=i(32184),T=i(7547),z=i(57300),D=i(47905),J=i(19216),R=i(86917),V=i(47968),B=i(81222),F=e=>{let{pages:t,onClose:i}=e,[r,o]=(0,v.useState)(null),s=e=>{o(r===e?null:e)};return(0,a.jsx)(n.Z,{children:(0,a.jsx)(O.Z,{children:t.map(e=>(0,a.jsxs)(n.Z,{children:[(0,a.jsx)(T.ZP,{disablePadding:!0,children:(0,a.jsxs)(z.Z,{onClick:()=>s(e),children:[(0,a.jsx)(D.Z,{primary:e.title}),r===e?(0,a.jsx)(V.Z,{}):(0,a.jsx)(B.Z,{})]})}),(0,a.jsx)(J.Z,{in:r===e,timeout:"auto",unmountOnExit:!0,children:(0,a.jsx)(O.Z,{component:"div",disablePadding:!0,sx:{pl:4},children:e.subPages.map(e=>(0,a.jsxs)(z.Z,{component:A.default,href:e.url,onClick:i,children:[(0,a.jsx)(R.Z,{children:e.icon}),(0,a.jsx)(D.Z,{primary:e.title})]},e.title))})})]},e.title))})})};let K=[{title:"VENTAS",subPages:[{title:"Clientes",url:"/pages/client",icon:(0,a.jsx)(k.Z,{})},{title:"Pedidos Por Enviar",url:"/pages/pedidoSinEnviar",icon:(0,a.jsx)(h.Z,{})},{title:"Pedidos Enviados",url:"/pages/pedidoEnviado",icon:(0,a.jsx)(h.Z,{})},{title:"Cotizaci\xf3n",url:"/pages/cotizacion",icon:(0,a.jsx)(f.Z,{})}]},{title:"CARTERA",subPages:[{title:"Cartera Clientes",url:"/pages/cartera",icon:(0,a.jsx)(x.Z,{})},{title:"Recibos",url:"/pages/cartera/recibo",icon:(0,a.jsx)(S.Z,{})},{title:"Consultar Consignaciones",url:"/pages/cartera/consignacion",icon:(0,a.jsx)(x.Z,{})},{title:"Elaborar Consignaciones",url:"/pages/cartera/elaborarCo",icon:(0,a.jsx)(y.Z,{})}]},{title:"INFORMES",subPages:[{title:"Ruteros Enviados",url:"/pages/gestionCartera",icon:(0,a.jsx)(g.Z,{})},{title:"Historico de Ventas",url:"/pages/historicoVenta",icon:(0,a.jsx)(S.Z,{})},{title:"Resumen Ventas Actual",url:"/pages/resumenVenta",icon:(0,a.jsx)(p.Z,{})}]},{title:"INVENTARIOS",subPages:[{title:"Consultar Articulos",url:"/pages/inventario",icon:(0,a.jsx)(j.Z,{})}]}];var U=()=>{let[e,t]=(0,v.useState)(null),[i,x]=(0,v.useState)(null),{auth:h,logout:g}=(0,b.a)(),p=(0,E.useRouter)();(0,v.useEffect)(()=>{(async()=>{try{let e=await fetch(N.x.url+"/users/verificar",{method:"GET",headers:{"Content-Type":"application/json"}});await e.json(),console.log("Existe Conexion: ",!0)}catch(e){console.log("No Existe Conexion: ",!1)}})()},[]);let f=e=>{t(e),x(null)},j=()=>{x(null)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.ZP,{}),(0,a.jsxs)(n.Z,{sx:{flexGrow:1},children:[(0,a.jsx)(o.Z,{position:"static",sx:{bgcolor:"#262626"},children:(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(l.Z,{color:"inherit",onClick:e=>{x(e.currentTarget)},sx:{display:{xs:"flex",md:"none"}},children:(0,a.jsx)(C.Z,{})}),(0,a.jsxs)(n.Z,{sx:{display:{xs:"none",md:"flex"},width:"100%"},children:[e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{color:"inherit",onClick:()=>{t(null)},children:(0,a.jsx)(m.Z,{})}),e.subPages.map(e=>(0,a.jsx)(c.Z,{color:"inherit",LinkComponent:A.default,href:e.url,children:e.title},e.title))]}):K.map(e=>(0,a.jsx)(c.Z,{color:"inherit",onClick:()=>f(e),children:e.title},e.title)),(0,a.jsx)(c.Z,{onClick:()=>{p.push("/pages"),setTimeout(()=>{P().fire({title:"\xbfDeseas Actualizar?",text:"Se actualizara la base de datos local!",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar"}).then(e=>{e.isConfirmed&&((async()=>{try{let e=await (0,w.zK)(),t=async function(t,i,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=await fetch(i),o=await n.json(),s=Array.isArray(o)?"function"==typeof r?r(o):o:[];if(!Array.isArray(s)){console.error("FilteredData no es un array:",s);return}let l=await e.getAll(t);for(let i of s){let r=l.find(e=>e[a]===i[a]);r&&JSON.stringify(r)===JSON.stringify(i)||await e.put(t,i)}for(let i of l)s.find(e=>e[a]===i[a])||await e.delete(t,i[a])};await t("articles",N.x.url+"/articles/articles/inventario","PKcodigo"),await t("cartera",N.x.url+"/carterasellers/".concat(h.IDSaler),"Documento"),await t("customers",N.x.url+"/customers/customers","NIT",e=>e.filter(e=>e.IDVendedor===h.IDSaler)),console.log("Datos actualizados en IndexedDB")}catch(e){console.log("Error al actualizar IndexedDB",e)}})(),P().fire({text:"Actualizando, este proceso tardara poco tiempo, espere por favor.",icon:"warning",timer:1e4,didOpen:()=>{P().showLoading()}}).then(()=>{P().fire({text:"Actualizaci\xf3n Exitosa!!",icon:"success"}).then(()=>{window.location.reload()})}))})},500)},color:"inherit",children:"Actualizar"})]}),(0,a.jsx)(u.Z,{variant:"h6",sx:{flexGrow:1}}),(0,a.jsx)(c.Z,{LinkComponent:A.default,href:"/pages",color:"inherit",children:(0,a.jsx)(Z.Z,{})}),(0,a.jsx)(c.Z,{color:"inherit",sx:{width:"15%"},children:h&&h.UserFullName}),(0,a.jsx)(c.Z,{onClick:()=>{g()},color:"inherit",children:"Salir"})]})}),(0,a.jsx)(d.Z,{id:"basic-menu",anchorEl:i,open:!!i,onClose:j,children:(0,a.jsx)(F,{pages:K,onClose:j})})]})]})}},89967:function(e,t,i){i.d(t,{x:function(){return a}});let a={url:"http://192.168.1.3:3000/api"}},85800:function(e,t,i){i.d(t,{a:function(){return l}});var a=i(57437),r=i(2265),n=i(16463),o=i(23739);let s=(0,r.createContext)({login:e=>{},logout:()=>{}});t.default=e=>{let{children:t}=e,i=(0,n.useRouter)(),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)({}),[x,h]=(0,r.useState)({}),[g,p]=(0,r.useState)({}),f=(0,r.useCallback)(function(e){document.cookie=(0,o.qC)("auth",JSON.stringify(e.signedUser),{maxAge:604800,path:"/",httpOnly:!1,secure:!1,sameSite:"Strict"}),localStorage.setItem("auth",JSON.stringify(e.signedUser)),localStorage.setItem("Tokens",JSON.stringify(e.token)),c(e.signedUser)},[]),j=(0,r.useCallback)(function(e){document.cookie=(0,o.qC)("auth","",{maxAge:-1,path:"/"}),localStorage.removeItem("auth"),localStorage.removeItem("Tokens"),i.push("/")},[]);(0,r.useEffect)(()=>{let e=localStorage.getItem("auth"),t=localStorage.getItem("clienteV"),i=localStorage.getItem("pedidoV"),a=localStorage.getItem("cartera");e&&c(JSON.parse(e)),t&&d(JSON.parse(t)),i&&h(JSON.parse(i)),a&&p(JSON.parse(a))},[]),(0,r.useEffect)(()=>{let e=(0,o.Qc)(document.cookie||"");e.auth&&c(JSON.parse(e.auth))},[]);let m=(0,r.useMemo)(()=>({auth:l,login:f,logout:j,clienteV:u,setClienteV:d,pedidosV:x,setPedidosV:h,carteraV:g,setCarteraV:p}),[l,u,x,g,f,j]);return(0,a.jsx)(s.Provider,{value:m,children:t})};let l=()=>(0,r.useContext)(s)}}]);