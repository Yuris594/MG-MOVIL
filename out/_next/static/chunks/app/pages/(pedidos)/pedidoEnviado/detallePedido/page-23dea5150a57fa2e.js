(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2418],{40010:(e,t,a)=>{Promise.resolve().then(a.bind(a,89010))},89010:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>F});var l=a(95155),o=a(23165),s=a(2572),i=a(22282),n=a(2241),r=a(51991),d=a(70689);a(92340);var c=a(10142),_=a(69253),h=a(12115);let u=function(e,t,a){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},[s]=(0,h.useState)(null),[i,n]=(0,h.useState)(""),[r]=(0,h.useState)((0,_.GP)(new Date,"dd/MM/yyyy HH:mm:ss"));return(0,h.useEffect)(()=>{(null==e?void 0:e.Fecha)&&(()=>{let t=new Date(e.Fecha),a=t.getDate(),l=t.toLocaleString("es-CO",{month:"short"}),o=l.charAt(0).toUpperCase()+l.slice(1),s=t.getFullYear();n("".concat(o," ").concat(a,", ").concat(s))})()},[e]),{generarPDF:()=>{let s=new c.default("portrait","pt","letter"),n=[{field:"FKcodigo_articles",headerName:"CODIGO",width:150},{field:"Nombre",headerName:"REFERENCIA",width:350},{field:"Cantidad",headerName:"CANTIDAD",width:100},{field:"Precio",headerName:"PRECIO",width:100},{field:"Descuento",headerName:"DESC",width:90},{field:"Iva",headerName:"IVA",width:90},{field:"Total",headerName:"TOTAL",width:100,cellClassName:"total-cell"}],d=a.map(e=>{let t=[];return n.forEach(a=>{let l=e[a.field];("Precio"===a.field||"Total"===a.field)&&(l="$"+parseFloat(Number(l).toFixed(0)).toLocaleString()),t.push(l)}),t});s.setFontSize(13),s.addImage("/logo_factura.png","PNG",16,20,200,25),s.setFontSize(8),s.setFont("courier","italic"),s.text("NOMBRE VENDEDOR: ".concat(t.UserFullName),450,25),s.text("".concat(r),450,35),s.setFontSize(10),s.text("___________________________________________________________________________________________________________",0,60),s.setFont("times","normal"),s.setFontSize(10),s.text("R. SOCIAL: ".concat(null==e?void 0:e.RazonSocial),16,85),s.text("No. PEDIDO: ".concat(null==e?void 0:e.NUMPED),16,105),s.text("FECHA PEDIDO: ".concat(i),200,105),s.text("NIT: ".concat(null==e?void 0:e.FKId_clientes),400,105),s.text("No. FACTURA: ",16,125),s.text("FECHA FACTURA: ",200,125),s.text("DOCUMENTO1: ".concat(null==e?void 0:e.Documento1),400,125),s.setTextColor(255,0,0),s.text("SUBTOTAL: $".concat(o),16,145),s.text("TOTAL: $".concat(l),200,145),s.setTextColor(0,0,0),s.text("NOTAS: ".concat(null==e?void 0:e.Notas),16,165),s.autoTable({head:[n.map(e=>e.headerName)],body:d,startY:180,theme:"plain",tableWidth:s.internal.pageSize.width-28,margin:{left:12,right:16},styles:{theme:"plain",cellWidth:"auto",styles:{cellPadding:5,fontSize:8},lineColor:[200,200,200],lineWidth:.1,font:"times",fontStyle:"normal",textColor:[0,0,0],display:"flex",fontSize:8},headStyles:{font:"courier",fontStyle:"bold"}}),s.output("dataurlnewwindow")},pdfDataUrl:s}};var m=a(76046),x=a(30251),g=a(48097),p=a(8889);let N=[{field:"FKcodigo_articles",headerName:"CODIGO",width:150},{field:"Nombre",headerName:"REFERENCIA",width:400},{field:"Cantidad",headerName:"CANTIDAD",width:100},{field:"Precio",headerName:"PRECIO",width:150,valueFormatter:e=>{let t=parseFloat(e).toFixed(0);return"$".concat(parseFloat(t).toLocaleString())}},{field:"Descuento",headerName:"DESCUENTO",width:150},{field:"Iva",headerName:"IVA",width:150},{field:"Total",headerName:"TOTAL",width:150,cellClassName:"total-cell",valueFormatter:e=>{let t=parseFloat(e).toFixed(0);return"$".concat(parseFloat(t).toLocaleString())}}],f=async e=>{let t=await fetch(p.m.url+"/pedidos/Pedidos_Enviados/".concat(e.NUMPED),{method:"GET",headers:{"Content-Type":"application/json"}});return t.ok||400!==t.status?t.json():(console.log("No hay articulos para este cliente"),[])},F=()=>{let e=(0,m.useRouter)(),{auth:t}=(0,d.A)(),[a,c]=(0,h.useState)(""),[_,p]=(0,h.useState)(""),[F,A]=(0,h.useState)(""),[S,j]=(0,h.useState)([]),[C,E]=(0,h.useState)(null),{generarPDF:w}=u(C,t,S,a,F),D=(0,o.A)("(max-width: 600px)");(0,h.useEffect)(()=>{C&&v(C.NUMPED)},[C]),(0,h.useEffect)(()=>{let e=localStorage.getItem("detallePedido");e&&E(JSON.parse(e)[0])},[]),(0,h.useEffect)(()=>{(null==C?void 0:C.Fecha)&&(()=>{let e=new Date(C.Fecha),t=e.getDate(),a=e.toLocaleString("es-CO",{month:"short"}),l=a.charAt(0).toUpperCase()+a.slice(1),o=e.getFullYear();p("".concat(l," ").concat(t,", ").concat(o))})()},[C]);let v=async()=>{try{let e=await f(C);e&&j(e)}catch(e){console.log(e)}};return(0,h.useEffect)(()=>{if(S.length>0){let e=S.reduce((e,t)=>{let a=parseFloat(t.Precio);return e+a*parseFloat(t.Cantidad)*(1-parseFloat(t.Descuento)/100)},0),t=S.reduce((e,t)=>e+parseFloat(t.Total),0),a=Number(e.toFixed(0)).toLocaleString(),l=Number(t.toFixed(0)).toLocaleString();A(a),c(l)}},[S]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.A,{}),(0,l.jsxs)(s.A,{sx:{display:"flex",flexDirection:D?"column":"row",justifyContent:"space-between",alignItems:"center",width:"auto",margin:2},children:[(0,l.jsxs)(g.A,{container:!0,rowSpacing:2,columnSpacing:70,children:[(0,l.jsx)(g.A,{size:{xs:12,sm:8,md:12},children:(0,l.jsx)("strong",{children:"MIGUEL G\xd3MEZ Y COMPA\xd1\xcdA S.A.S"})}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:12},children:[(0,l.jsx)("strong",{children:"Nombre Vendedor: "}),null==t?void 0:t.UserFullName]})]}),(0,l.jsxs)(s.A,{sx:{margin:2},children:[(0,l.jsx)(i.A,{onClick:w,color:"success",children:"Generar PDF"}),(0,l.jsx)(i.A,{onClick:()=>{localStorage.removeItem("detallePedido"),e.push("/pages/pedidoEnviado")},color:"error",children:"Cerrar"})]})]}),(0,l.jsx)(n.A,{}),(0,l.jsx)(s.A,{sx:{display:"flex",margin:2},children:(0,l.jsxs)(g.A,{container:!0,rowSpacing:2,columnSpacing:14,children:[(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"No. Pedido: "}),(null==C?void 0:C.NUMPED)||""]}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Fecha Pedido: "}),_||""]}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Nit: "}),(null==C?void 0:C.FKId_clientes)||""]}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:8},children:[(0,l.jsx)("strong",{children:"R. Social: "}),(null==C?void 0:C.RazonSocial)||""]}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Fecha Factura: "}),(null==C?void 0:C.Fecha_Factura)||""]}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"SubTotal: "}),(0,l.jsxs)("span",{style:{color:"red"},children:["$",F]})]}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Total: "}),(0,l.jsxs)("span",{style:{color:"red"},children:["$",a]})]}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Documento1: "}),(null==C?void 0:C.Documento1)||""]}),(0,l.jsxs)(g.A,{size:{xs:12,sm:8,md:6},children:[(0,l.jsx)("strong",{children:"Notas: "}),(null==C?void 0:C.Notas)||""]})]})}),(0,l.jsx)(s.A,{sx:{height:"auto",width:"auto",margin:2},children:(0,l.jsx)(x.z,{rows:S,columns:N,getRowId:e=>e.FKcodigo_articles,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[10],sx:{color:"#000",bgcolor:"#fff"}})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8320,3930,3509,4017,4269,5065,251,1647,7222,1991,8441,1517,7358],()=>t(40010)),_N_E=e.O()}]);