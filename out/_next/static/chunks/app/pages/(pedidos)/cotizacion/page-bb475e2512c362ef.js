(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8695],{4374:function(e,t,a){Promise.resolve().then(a.bind(a,87987))},87987:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var i=a(57437),o=a(79647),r=a(76548),n=a(17156),l=a(48965),d=a(37241),s=a(47703);a(27824),a(97501);var c=a(85800),f=a(30309),h=a(2265),u=a(86934),m=a(80219);let x={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",maxHeight:"90vh",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,overflow:"auto",p:4};var p=()=>{let{auth:e,setPedidosV:t}=(0,c.a)(),[a,p]=(0,h.useState)(!1),[w,g]=(0,h.useState)([]),[C,b]=(0,h.useState)([]),[S,v]=(0,h.useState)([]),[j,N]=(0,h.useState)(null),Z=(0,o.Z)("(max-width: 600px)"),z=e=>{N(e),p(!0)},E=()=>{p(!1),N(null)};(0,h.useEffect)(()=>{let e=(JSON.parse(localStorage.getItem("cotizacion"))||[]).map(e=>({...e,fechaFormateada:k(e.fecha)}));g(e),v(e)},[]);let k=e=>{let t=new Date(e),a=t.getDate().toString().padStart(2,"0"),i=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getFullYear();return"".concat(i,"/").concat(a,"/").concat(o)},P=e=>{let t=w.filter(t=>t.PKId!==e.PKId);localStorage.setItem("cotizacion",JSON.stringify(t)),g(t)},I=e=>{g(S.filter(t=>Object.values(t).map(e=>e?e.toString().toLowerCase():"").some(t=>t.includes(e.toLowerCase()))))},y=async t=>{if(!(await Swal.fire({title:"Enviar PDF!",text:"\xbfDesea Enviar la Cotizaci\xf3n al Cliente?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar",cancelButtonText:"Cancelar"})).isConfirmed){Swal.fire({text:"El PDF no se envi\xf3.",icon:"info",timer:3e3});return}let a=await e.UserEmail,i=null==t?void 0:t.email;try{await fetch("http://localhost:4000/enviar-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,correoUsuario:a,correoCliente:i})}),Swal.fire({title:"\xa1\xc9xito!",text:"La Cotizaci\xf3n fue Enviada.",icon:"success",timer:3e3})}catch(e){console.error("Error generando el PDF:",e),Swal.fire({title:"Oops...!",text:"Hubo un problema al Enviar la Cotizaci\xf3n.",icon:"error"})}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.Z,{}),(0,i.jsxs)(m.Z,{container:!0,direction:"column",sx:{minHeight:"100vh",backfroundColor:"#ffffff",padding:3},children:[(0,i.jsx)(m.Z,{size:12,children:(0,i.jsxs)(n.Z,{sx:{display:"flex",flexDirection:Z?"column":"row",alignItems:"center",justifyContent:"space-between",mb:3},children:[(0,i.jsx)("h2",{children:(0,i.jsx)("strong",{children:"COTIZACI\xd3N"})}),(0,i.jsx)(l.Z,{variant:"outlined",value:C,onChange:e=>{b(e.target.value),I(e.target.value),console.log(e.target.value)},label:"Buscar",sx:{width:Z?"100%":350,backgroundColor:"#fff",borderRadius:2}})]})}),(0,i.jsx)(m.Z,{size:12,sx:{flexGrow:1},children:(0,i.jsx)(n.Z,{sx:{width:"100%",heigth:Z?500:750,borderRadius:2},children:(0,i.jsx)(u._,{rows:w,columns:[{field:"PKId",headerName:"No",width:80},{field:"fechaFormateada",headerName:"Fecha",width:150},{field:"nit",headerName:"NIT",width:150},{field:"nombreC",headerName:"Nombre o Razon Social",width:400},{field:"enviar",headerName:"",width:100,renderCell:e=>(0,i.jsx)(r.Z,{onClick:()=>y(e.row),"aria-label":"enviar",color:"success",sx:{fontSize:12},children:"Enviar PDF"})},{field:"editar",headerName:"",width:100,renderCell:e=>(0,i.jsx)(r.Z,{onClick:()=>z(e.row),"aria-label":"editar",sx:{fontSize:12},children:"Modificar"})},{field:"actions",headerName:"",width:100,renderCell:e=>(0,i.jsx)(r.Z,{onClick:()=>P(e.row),"aria-label":"cancel",color:"error",sx:{fontSize:12},children:"Eliminar"})}],getRowId:e=>e.PKId,initialState:{pagination:{paginationModel:{pageSize:10}}},pageSizeOptions:[5,10,15]})})})]}),(0,i.jsx)(d.Z,{open:a,onClose:E,BackdropProps:{onClick:e=>e.stopPropagation()},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,i.jsx)(n.Z,{sx:x,children:(0,i.jsx)(f.default,{pedido:j,handleClose:E})})})]})}}},function(e){e.O(0,[9461,2505,4759,1513,1929,5202,6934,2398,4108,7703,309,2971,7023,1744],function(){return e(e.s=4374)}),_N_E=e.O()}]);