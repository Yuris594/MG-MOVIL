"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8730],{42569:function(e,t,a){a.d(t,{b:function(){return n},zK:function(){return i}});var r=a(90960);let i=async()=>await (0,r.X3)("IDBService",1,{upgrade(e){e.createObjectStore("articles",{keyPath:"id",autoIncrement:!0}),e.createObjectStore("cartera",{keyPath:"id",autoIncrement:!0}),e.createObjectStore("customers",{keyPath:"id",autoIncrement:!0})}}),n=async()=>{let e=await i(),t=["articles","cartera","customers"],a=e.transaction(t,"readwrite");for(let e of t)await a.objectStore(e).clear()}},98730:function(e,t,a){a.d(t,{Z:function(){return U}});var r=a(57437),i=a(93062),n=a(2069),s=a(71495),o=a(71004),l=a(59832),c=a(94013),u=a(46387),d=a(84011),x=a(94574),h=a(47666),p=a(87222),f=a(5774),g=a(70412),j=a(20049),m=a(67257),Z=a(45319),C=a(42581),S=a(66463),y=a(38389),b=a(72549),w=a(42569),k=a(10932),v=a(99376),A=a(2265),E=a(41698),I=a(5515),P=a.n(I),O=a(27648),N=a(15273),z=a(73261),R=a(11741),T=a(67051),B=a(17162),V=a(53431),J=a(60268),D=a(52700),q=e=>{let{pages:t,onClose:a}=e,[i,s]=(0,A.useState)(null),o=e=>{s(i===e?null:e)};return(0,r.jsx)(n.Z,{children:(0,r.jsx)(N.Z,{children:t.map(e=>(0,r.jsxs)(n.Z,{children:[(0,r.jsx)(z.ZP,{disablePadding:!0,children:(0,r.jsxs)(R.Z,{onClick:()=>o(e),children:[(0,r.jsx)(T.Z,{primary:e.title}),i===e?(0,r.jsx)(J.Z,{}):(0,r.jsx)(D.Z,{})]})}),(0,r.jsx)(B.Z,{in:i===e,timeout:"auto",unmountOnExit:!0,children:(0,r.jsx)(N.Z,{component:"div",disablePadding:!0,sx:{pl:4},children:e.subPages.map(e=>(0,r.jsxs)(R.Z,{component:O.default,href:e.url,onClick:a,children:[(0,r.jsx)(V.Z,{children:e.icon}),(0,r.jsx)(T.Z,{primary:e.title})]},e.title))})})]},e.title))})})};let F=[{title:"VENTAS",subPages:[{title:"Clientes",url:"/pages/client",icon:(0,r.jsx)(b.Z,{})},{title:"Pedidos Por Enviar",url:"/pages/pedidoSinEnviar",icon:(0,r.jsx)(h.Z,{})},{title:"Pedidos Enviados",url:"/pages/pedidoEnviado",icon:(0,r.jsx)(h.Z,{})},{title:"Cotizaciones",url:"/pages/cotizacion",icon:(0,r.jsx)(g.Z,{})}]},{title:"CARTERA",subPages:[{title:"Cartera Clientes",url:"/pages/cartera",icon:(0,r.jsx)(x.Z,{})},{title:"Recibos",url:"/pages/cartera/recibo",icon:(0,r.jsx)(C.Z,{})},{title:"Consultar Consignaciones",url:"/pages/cartera/consignacion",icon:(0,r.jsx)(x.Z,{})},{title:"Elaborar Consignaciones",url:"/pages/cartera/elaborarCo",icon:(0,r.jsx)(y.Z,{})}]},{title:"INFORMES",subPages:[{title:"Ruteros Enviados",url:"/pages/gestionCartera",icon:(0,r.jsx)(p.Z,{})},{title:"Historico de Ventas",url:"/pages/historicoVenta",icon:(0,r.jsx)(C.Z,{})},{title:"Resumen Ventas Actual",url:"/pages/resumenVenta",icon:(0,r.jsx)(f.Z,{})}]},{title:"INVENTARIOS",subPages:[{title:"Consultar Articulos",url:"/pages/inventario",icon:(0,r.jsx)(j.Z,{})}]}];var U=()=>{let[e,t]=(0,A.useState)(null),[a,x]=(0,A.useState)(null),{auth:h,logout:p}=(0,k.a)(),f=(0,v.useRouter)();(0,A.useEffect)(()=>{(async()=>{try{let e=await fetch(E.x.url+"/users/verificar",{method:"GET",headers:{"Content-Type":"application/json"}});await e.json()}catch(e){}})()},[]);let g=e=>{t(e),x(null)},j=()=>{x(null)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.ZP,{}),(0,r.jsxs)(n.Z,{sx:{flexGrow:1},children:[(0,r.jsx)(s.Z,{position:"static",sx:{bgcolor:"#262626"},children:(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(l.Z,{color:"inherit",onClick:e=>{x(e.currentTarget)},sx:{display:{xs:"flex",md:"none"}},children:(0,r.jsx)(S.Z,{})}),(0,r.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(n.Z,{sx:{display:{xs:"none",md:"flex"},width:"100%"},children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{color:"inherit",onClick:()=>{t(null)},children:(0,r.jsx)(m.Z,{})}),e.subPages.map(e=>(0,r.jsx)(c.Z,{color:"inherit",LinkComponent:O.default,href:e.url,children:e.title},e.title))]}):F.map(e=>(0,r.jsx)(c.Z,{color:"inherit",onClick:()=>g(e),children:e.title},e.title))}),(0,r.jsx)(c.Z,{onClick:()=>{f.push("/pages"),P().fire({title:"\xbfDeseas Actualizar?",text:"Se actualizar\xe1 la base de datos local!",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar"}).then(async e=>{e.isConfirmed&&P().fire({title:"Actualizando, este proceso tardara poco tiempo, espere por favor.",icon:"warning",allowOutsideClick:!1,didOpen:async()=>{P().showLoading();try{let e=await (0,w.zK)();await (0,w.b)();let t=async(t,a,r)=>{if(Array.isArray(a))for(let r of a)try{await e.put(t,r)}catch(e){}},[a,r,i]=await Promise.all([fetch("".concat(E.x.url,"/articles/articles/inventario")),fetch("".concat(E.x.url,"/carterasellers/").concat(h.IDSaler)),fetch("".concat(E.x.url,"/customers/customers"))]),[n,s,o]=await Promise.all([a.json(),r.json(),i.json()]),l=Array.isArray(n)?n:n.data||[],c=Array.isArray(s)?s:s.cxc||[],u=Array.isArray(o)?o.filter(e=>e.IDVendedor===h.IDSaler):[];await t("articles",l,"id"),await t("cartera",c,"id"),await t("customers",u,"id"),P().close(),P().fire({title:"Actualizaci\xf3n Exitosa!",icon:"success"}).then(()=>{f.push("/pages")})}catch(e){P().fire({title:"Error al actualizar los datos",text:"Int\xe9ntalo de nuevo m\xe1s tarde.",icon:"error"})}}})})},color:"inherit",children:"Actualizar"})]}),(0,r.jsx)(u.Z,{variant:"h6",sx:{flexGrow:1}}),(0,r.jsx)(c.Z,{LinkComponent:O.default,href:"/pages",color:"inherit",children:(0,r.jsx)(Z.Z,{})}),(0,r.jsx)(c.Z,{color:"inherit",sx:{width:"15%"},children:h&&h.UserFullName}),(0,r.jsx)(c.Z,{onClick:()=>{P().fire({title:"\xbfCerrara Sesi\xf3n?",text:"Desea salir de la aplicaci\xf3n, Recuerde que para ingresar nuevamente debe tener conexi\xf3n con la empresa e internet.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar"}).then(e=>{e.isConfirmed&&((0,w.b)(),p(),f.push("/"))})},color:"inherit",children:"Salir"})]})}),(0,r.jsx)(d.Z,{id:"basic-menu",anchorEl:a,open:!!a,onClose:j,children:(0,r.jsx)(q,{pages:F,onClose:j})})]})]})}},41698:function(e,t,a){a.d(t,{x:function(){return r}});let r={url:"http://192.168.1.3:3010/api"}},10932:function(e,t,a){a.d(t,{a:function(){return l}});var r=a(57437),i=a(2265),n=a(99376),s=a(27696);let o=(0,i.createContext)({login:e=>{},logout:()=>{}});t.default=e=>{let{children:t}=e;(0,n.useRouter)();let[a,l]=(0,i.useState)(null),[c,u]=(0,i.useState)({}),[d,x]=(0,i.useState)({}),[h,p]=(0,i.useState)({}),f=(0,i.useCallback)(function(e){document.cookie=(0,s.qC)("auth",JSON.stringify(e.signedUser),{maxAge:604800,path:"/",httpOnly:!1,secure:!1,sameSite:"Strict"}),localStorage.setItem("auth",JSON.stringify(e.signedUser)),localStorage.setItem("Tokens",JSON.stringify(e.token)),l(e.signedUser)},[]),g=(0,i.useCallback)(function(e){document.cookie=(0,s.qC)("auth","",{maxAge:-1,path:"/"}),localStorage.removeItem("auth"),localStorage.removeItem("Tokens")},[]);(0,i.useEffect)(()=>{let e=localStorage.getItem("auth"),t=localStorage.getItem("clienteV"),a=localStorage.getItem("pedidoV"),r=localStorage.getItem("cartera");e&&l(JSON.parse(e)),t&&u(JSON.parse(t)),a&&x(JSON.parse(a)),r&&p(JSON.parse(r))},[]),(0,i.useEffect)(()=>{let e=(0,s.Qc)(document.cookie||"");e.auth&&l(JSON.parse(e.auth))},[]);let j=(0,i.useMemo)(()=>({auth:a,login:f,logout:g,clienteV:c,setClienteV:u,pedidosV:d,setPedidosV:x,carteraV:h,setCarteraV:p}),[a,c,d,h,f,g]);return(0,r.jsx)(o.Provider,{value:j,children:t})};let l=()=>(0,i.useContext)(o)}}]);