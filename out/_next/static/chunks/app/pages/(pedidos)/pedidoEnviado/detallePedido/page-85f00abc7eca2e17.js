(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7284],{68797:function(e,t,a){Promise.resolve().then(a.bind(a,7636))},7636:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var l=a(57437),o=a(70899),s=a(2069),r=a(94013),i=a(8350),n=a(98730),d=a(10932);a(2578);var c=a(53375),_=a(56424),h=a(2265),u=function(e,t,a){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},[s]=(0,h.useState)(null),[r,i]=(0,h.useState)(""),[n]=(0,h.useState)((0,_.WU)(new Date,"dd/MM/yyyy HH:mm:ss"));return(0,h.useEffect)(()=>{(null==e?void 0:e.Fecha)&&(()=>{let t=new Date(e.Fecha),a=t.getDate(),l=t.toLocaleString("es-CO",{month:"short"}),o=l.charAt(0).toUpperCase()+l.slice(1),s=t.getFullYear();i("".concat(o," ").concat(a,", ").concat(s))})()},[e]),{generarPDF:()=>{let s=new c.default("portrait","pt","letter"),i=[{field:"FKcodigo_articles",headerName:"CODIGO",width:150},{field:"Nombre",headerName:"REFERENCIA",width:350},{field:"Cantidad",headerName:"CANTIDAD",width:100},{field:"Precio",headerName:"PRECIO",width:100},{field:"Descuento",headerName:"DESC",width:90},{field:"Iva",headerName:"IVA",width:90},{field:"Total",headerName:"TOTAL",width:100,cellClassName:"total-cell"}],d=a.map(e=>{let t=[];return i.forEach(a=>{let l=e[a.field];("Precio"===a.field||"Total"===a.field)&&(l="$"+parseFloat(Number(l).toFixed(0)).toLocaleString()),t.push(l)}),t});s.setFontSize(13),s.addImage("/logo_factura.png","PNG",16,20,200,25),s.setFontSize(8),s.setFont("courier","italic"),s.text("NOMBRE VENDEDOR: ".concat(t.UserFullName),450,25),s.text("".concat(n),450,35),s.setFontSize(10),s.text("___________________________________________________________________________________________________________",0,60),s.setFont("times","normal"),s.setFontSize(10),s.text("R. SOCIAL: ".concat(null==e?void 0:e.RazonSocial),16,85),s.text("No. PEDIDO: ".concat(null==e?void 0:e.NUMPED),16,105),s.text("FECHA PEDIDO: ".concat(r),200,105),s.text("NIT: ".concat(null==e?void 0:e.FKId_clientes),400,105),s.text("No. FACTURA: ",16,125),s.text("FECHA FACTURA: ",200,125),s.text("DOCUMENTO1: ".concat(null==e?void 0:e.Documento1),400,125),s.setTextColor(255,0,0),s.text("SUBTOTAL: $".concat(o),16,145),s.text("TOTAL: $".concat(l),200,145),s.setTextColor(0,0,0),s.text("NOTAS: ".concat(null==e?void 0:e.Notas),16,165),s.autoTable({head:[i.map(e=>e.headerName)],body:d,startY:180,theme:"plain",tableWidth:s.internal.pageSize.width-28,margin:{left:12,right:16},styles:{theme:"plain",cellWidth:"auto",styles:{cellPadding:5,fontSize:8},lineColor:[200,200,200],lineWidth:.1,font:"times",fontStyle:"normal",textColor:[0,0,0],display:"flex",fontSize:8},headStyles:{font:"courier",fontStyle:"bold"}}),s.output("dataurlnewwindow")},pdfDataUrl:s}},m=a(99376),x=a(93769),g=a(29239),N=a(41698);let F=[{field:"FKcodigo_articles",headerName:"CODIGO",width:150,headerClassName:"header-bold"},{field:"Nombre",headerName:"REFERENCIA",width:400,headerClassName:"header-bold"},{field:"Cantidad",headerName:"CANTIDAD",width:100,headerClassName:"header-bold"},{field:"Precio",headerName:"PRECIO",width:150,valueFormatter:e=>{let t=parseFloat(e).toFixed(0);return"".concat(parseFloat(t).toLocaleString())},headerClassName:"header-bold"},{field:"Descuento",headerName:"DESCUENTO",width:150,valueFormatter:e=>{let t=parseFloat(e).toLocaleString();return"".concat(parseFloat(t).toFixed(1))},headerClassName:"header-bold"},{field:"Iva",headerName:"IVA",width:150,valueFormatter:e=>{let t=parseFloat(e).toLocaleString();return"".concat(parseFloat(t).toFixed(1))},headerClassName:"header-bold"},{field:"Total",headerName:"TOTAL",width:150,cellClassName:"total-cell",valueFormatter:e=>{let t=parseFloat(e).toFixed(0);return"".concat(parseFloat(t).toLocaleString())},headerClassName:"header-bold"}],f=async e=>{let t=await fetch(N.x.url+"/pedidos/Pedidos_Enviados/".concat(e.NUMPED),{method:"GET",headers:{"Content-Type":"application/json"}});return t.ok||400!==t.status?t.json():(console.log("No hay articulos para este cliente"),[])};var p=()=>{let e=(0,m.useRouter)(),{auth:t}=(0,d.a)(),[a,c]=(0,h.useState)(""),[_,N]=(0,h.useState)(""),[p,S]=(0,h.useState)(""),[C,j]=(0,h.useState)([]),[E,w]=(0,h.useState)(null),{generarPDF:D}=u(E,t,C,a,p),v=(0,o.Z)("(max-width: 600px)");(0,h.useEffect)(()=>{E&&T(E.NUMPED)},[E]),(0,h.useEffect)(()=>{let e=localStorage.getItem("detallePedido");e&&w(JSON.parse(e)[0])},[]),(0,h.useEffect)(()=>{(null==E?void 0:E.Fecha)&&(()=>{let e=new Date(E.Fecha),t=e.getDate(),a=e.toLocaleString("es-CO",{month:"short"}),l=a.charAt(0).toUpperCase()+a.slice(1),o=e.getFullYear();N("".concat(l," ").concat(t,", ").concat(o))})()},[E]);let T=async()=>{try{let e=await f(E);e&&j(e)}catch(e){console.log(e)}};return(0,h.useEffect)(()=>{if(C.length>0){let e=C.reduce((e,t)=>{let a=parseFloat(t.Precio);return e+a*parseFloat(t.Cantidad)*(1-parseFloat(t.Descuento)/100)},0),t=C.reduce((e,t)=>e+parseFloat(t.Total),0),a=Number(e.toFixed(0)).toLocaleString(),l=Number(t.toFixed(0)).toLocaleString();S(a),c(l)}},[C]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.Z,{}),(0,l.jsxs)(s.Z,{sx:{display:"flex",flexDirection:v?"column":"row",justifyContent:"space-between",alignItems:"center",width:"auto",margin:2},children:[(0,l.jsxs)(g.Z,{container:!0,rowSpacing:2,columnSpacing:70,children:[(0,l.jsx)(g.Z,{size:{xs:12,sm:8,md:12},children:(0,l.jsx)("strong",{children:"MIGUEL G\xd3MEZ Y COMPA\xd1\xcdA S.A.S"})}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:12},children:[(0,l.jsx)("strong",{children:"Nombre Vendedor: "}),null==t?void 0:t.UserFullName]})]}),(0,l.jsxs)(s.Z,{sx:{margin:2},children:[(0,l.jsx)(r.Z,{onClick:D,color:"success",children:"Generar PDF"}),(0,l.jsx)(r.Z,{onClick:()=>{localStorage.removeItem("detallePedido"),e.push("/pages/pedidoEnviado")},color:"error",children:"Cerrar"})]})]}),(0,l.jsx)(i.Z,{}),(0,l.jsx)(s.Z,{sx:{display:"flex",margin:2},children:(0,l.jsxs)(g.Z,{container:!0,rowSpacing:2,columnSpacing:14,children:[(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"No. Pedido: "}),(null==E?void 0:E.NUMPED)||""]}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Fecha Pedido: "}),_||""]}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Nit: "}),(null==E?void 0:E.FKId_clientes)||""]}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:8},children:[(0,l.jsx)("strong",{children:"R. Social: "}),(null==E?void 0:E.RazonSocial)||""]}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Fecha Factura: "}),(null==E?void 0:E.Fecha_Factura)||""]}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"SubTotal: "}),(0,l.jsxs)("span",{style:{color:"red"},children:["$",p]})]}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Total: "}),(0,l.jsxs)("span",{style:{color:"red"},children:["$",a]})]}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:4},children:[(0,l.jsx)("strong",{children:"Documento1: "}),(null==E?void 0:E.Documento1)||""]}),(0,l.jsxs)(g.Z,{size:{xs:12,sm:8,md:6},children:[(0,l.jsx)("strong",{children:"Notas: "}),(null==E?void 0:E.Notas)||""]})]})}),(0,l.jsx)(s.Z,{sx:{height:"auto",width:"auto",margin:2},children:(0,l.jsx)(x._,{rows:C,columns:F,getRowId:e=>e.FKcodigo_articles,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[10],sx:{color:"#000",bgcolor:"#fff"}})})]})}}},function(e){e.O(0,[9461,2505,173,7584,5615,1238,3840,3683,8070,8730,2971,2117,1744],function(){return e(e.s=68797)}),_N_E=e.O()}]);